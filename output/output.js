var _config,gApp;navigator.userAgent.match("QQBrowser")&&document.body.classList.add("qq-browser");var newImgList=[],tabId=location.href.match(/tabId=(\d+)/);tabId=tabId?parseInt(tabId[1]):"";var tabTitle="",startedTabIds=[],outputType=location.href.match(/type=(.+?)(&|$)/),pageInfos=[];function main(e){function t(e){chrome.runtime.sendMessage({cmd:"GET_ADVANCEC_IMGS",tabId:e.id},function(t){var i=t.map(function(e){return e.src});chrome.tabs.sendMessage(e.id,{cmd:"GET_IMAGE_FROM_BG3",tabInfo:e,imgReqList:i})})}document.title="drag"==outputType?utils.getI18n("outputDragDownloadTitle"):utils.getI18n("outputPageTitle"),chrome.runtime.onMessage.addListener(function(e,t,i){if(!tabId||e.tabId==tabId||t.tab.id==tabId)if("ADD_IMG"==e.cmd)if(outputType){if(e.type==outputType&&(n.addItem(e.item),"drag"==e.type)){var o=document.title;document.title=utils.getI18n("new_image_added"),favico=document.getElementById("favico"),favico.href=e.item.smallUrl,setTimeout(function(){document.title=o,favico.href="../icon-small.png"},2e3)}}else e.type||n.addItem(e.item);else if("ADD_IMG_LIST"==e.cmd)!function(e,t){function i(){if(!(n>=e.length)){var o=e[n];n++;var s=setTimeout(function(){i()},3e3);o?"string"==typeof o?new ParsedPItem({src:o},n,t.tab,t.frameId,function(t){gApp.addItem(t),n<e.length&&(clearTimeout(s),i())}):"VIDEO"==o.type?new VItem(o,n,t.tab,t.frameId,function(t){gApp.addItem(t),n<e.length&&(clearTimeout(s),i())}):new ParsedPItem(o,n,t.tab,t.frameId,function(t){gApp.addItem(t),n<e.length&&(clearTimeout(s),i())}):i()}}e=(e=e.filter(e=>"string"==typeof e&&e||e.src)).filter(function(e){return!!e});for(var n=0,o=0;o<10;o++)i()}(e.list,t);else if("ADD_VIDEO"==e.cmd)n.addItem(e.item);else if("SET_GROUPS"==e.cmd)n.groups2=e.groups;else if("SET_PAGE_INFO"==e.cmd){for(var s=0;s<pageInfos.length;s++)if(pageInfos[s].tabId==t.tab.id){pageInfos.splice(s,1);break}pageInfos.push({tabId:t.tab.id,value:e.pageInfo})}else"SET_HEADERS"==e.cmd?(setHeaders(e.headers),i&&i()):"SET_CROSS_DOMAIN"==e.cmd?(setCrossDomain(),i&&i()):"SUPPORT_COLLECT_PAUSE"==e.cmd?gApp.supportcollectpause=!0:"COLLECT_COMPLETED"==e.cmd?gApp.collectCompleted=!0:"SET_EXTRA_INFO"==e.cmd&&(gApp.extraInfo=e.extraInfo);return!0}),window.addEventListener("resize",function(){n.winInnerWidth=Math.max(i,window.innerWidth-("left"==gConfig.topOrLeft?210:0)),n.winInnerHeight=window.innerHeight});var i=1280;var n=gApp=new Vue({el:"#app",data:{imgList:[],groups1:[],groups2:[],maxWidth:e.rememberFilter&&e.widthRange?e.widthRange[1]||e.widthRange[0]:0,maxHeight:e.rememberFilter&&e.heightRange?e.heightRange[1]||e.heightRange[0]:0,minInnerWidth:i,winInnerWidth:Math.max(i,window.innerWidth-("left"==gConfig.topOrLeft?210:0)),winInnerHeight:window.innerHeight,urlfilter:"",config:e,showOutputTextPanel:!1,downloader:downloader,viewModel:"normal",currentPage:1,selectionBoxStyling:{},startedTabs:[],selectedTabs:"",showSaveTips:!1,saveTipsDoNotShowAgain:JSON.parse(localStorage.saveTipsDoNotShowAgain||"false"),widthRange:e.rememberFilter&&e.widthRange?[e.widthRange[0],e.widthRange[1]||e.widthRange[0]]:[0,0],heightRange:e.rememberFilter&&e.heightRange?[e.heightRange[0],e.heightRange[1]||e.heightRange[0]]:[0,0],renameInputFocused:!1,filterInputFocused:!1,showRenameDialog:!1,editingRenameRule:e.renameRule,showRenameRuleDetail:!1,brand:gConfig.brand,gConfig:gConfig,topOrLeft:gConfig.topOrLeft,name:gConfig.name,stzsLink:"https://chrome.google.com/webstore/detail/kldhhobmmejaeaiilomaibhjlcfpceac?authuser=2&hl="+navigator.language,stzsen:!1,stzsAdClicked:!0,adBtnClicked:localStorage.outputAdBtnClicked,adLink:AD_LINK_ST,supportcollectpause:!1,collectPaused:!1,collectCompleted:!1,extraInfo:"",language:navigator.language,downloading:!1},computed:{fixTopHeight:function(){return"left"==gConfig.topOrLeft?0:this.config.showMore?80:40},itemStyle:function(){return this.config.pagination&&this.bigView&&"spread"!=this.viewModel?{width:this.itemWidth-10+"px",height:this.itemWidth-10+"px"}:{}},showPagination:function(){return this.config.pagination&&"normal"==this.viewModel&&this.showImgList.length>this.pageSize},mainContentHeight:function(){return this.winInnerHeight-this.fixTopHeight-(this.showPagination?60:0)},picListWidth:function(){return this.itemWidth*parseInt(this.winInnerWidth/this.itemWidth)},contentHeight:function(){return this.winInnerHeight-this.fixTopHeight-30-60},showPagination:function(){return this.config.pagination&&"normal"==this.viewModel&&0==this.groups.length},itemWidth:function(){if(this.showPagination){var e=parseInt(this.contentHeight/250);return this.contentHeight%250>125?this.bigView?parseInt(this.contentHeight/(e+1)):130:this.bigView?250:130}return this.bigView?250:130},pageSize:function(){return parseInt(window.innerWidth/this.itemWidth)*parseInt(this.contentHeight/this.itemWidth)},groups:function(){return this.groups2.length>0?this.groups2:this.groups1},needRename:{get:function(){return e.needRename},set:function(t){e.needRename=t,appConfig.setConfig(e)}},renameRule:{get:function(){return e.renameRule},set:function(t){e.renameRule=t,appConfig.setConfig(e)}},bigView:{get:function(){return"big"==e.previewSize}},unique:{get:function(){return e.unique},set:function(t){e.unique=t,appConfig.setConfig(e)}},concurrent:{get:function(){return e.limitConcurrent},set:function(t){e.limitConcurrent=t,appConfig.setConfig(e)}},rememberFilter:{get:function(){return e.rememberFilter},set:function(t){e.rememberFilter=t,appConfig.setConfig(e)}},outputTextFormat:{get:function(){return e.outputTextFormat},set:function(t){e.outputTextFormat=t,appConfig.setConfig(e)}},showImgList:function(){var t=this,i=[],n=this.urlfilter.replace("，",",").split(",").join(".*");this.imgList.forEach(function(e){e.originalUrl&&t.checkSize(e)&&(0==t.selectedTabs.length||t.selectedTabs.indexOf(e.tabId)>=0)&&(!n||(e.originalUrl+e.alt+e.group).match(new RegExp(n,"i")))&&i.push(e)}),this.config.unique&&(i=_.uniqWith(i,function(e,t){var i=e.bigUrl||e.originalUrl,n=t.bigUrl||t.originalUrl;return e.group==t.group&&i==n}));var o=e.sortType;return"default"==o?i.sort(function(e,t){return e.tabIndex!=t.tabIndex?e.tabIndex-t.tabIndex:e.index-t.index}):"site"==o||("bigFirst"==o?i.sort(function(e,t){return t.size-e.size}):"smallFirst"==o&&i.sort(function(e,t){return e.size-t.size})),i.forEach(function(e,t){e.showIndex=t}),i},currentPageImgs:function(){return this.config.pagination&&"spread"!=this.viewModel?this.showImgList.slice(this.pageSize*(this.currentPage-1),this.pageSize*this.currentPage):this.showImgList},selectedImgs:function(){var e=[];return this.showImgList.forEach(function(t){t.selected&&(t.selectIndex=e.length,e.push(t))}),e},groupedImgs:function(){var e=this,t=this.groups.map(function(t){return{title:t,imgs:_.filter(e.showImgList,{group:t})}});_.remove(t,function(e){return 0==e.imgs.length});var i=_.filter(e.showImgList,{group:""});i.length>0&&t.push({title:this.getI18n("others"),imgs:i});var n=0;return t.forEach(function(e){e.imgs.forEach(function(e,t){e.showIndex=n,e.grouIndex=t,n++})}),t},downloadedImgs:function(){var e=[];return this.showImgList.forEach(function(t){"complete"==t.status&&e.push(t)}),e},interruptedImgs:function(){var e=[];return this.showImgList.forEach(function(t){"interrupted"==t.status&&e.push(t)}),e},outputText:function(){var e=this.config.outputTextFormat,t=[];return this.selectedImgs.forEach(function(i,n){var o=i.bigUrl,s=utils.replaceVarible({text:e,index:n,link:o,group:i.group,group_en:i.group_en||i.group});t.push(s)}),t.join("\n")},downloaderStatus:function(){return downloader.status}},mounted:function(){var i=this;if(!location.href.match("justopen=1")){if(tabId)chrome.tabs.get(tabId,function(e){tabTitle=e.title,document.title=tabTitle,t(e)});else{function n(){var e=JSON.parse(localStorage.imageTabIds||"[]");e.length>startedTabIds.length&&(e.slice(startedTabIds.length).forEach(function(e){chrome.tabs.get(e,function(e){utils.checkTabDownloadableByUrl(e.url)&&(t(e),e.shortTitle=e.title.length<40?e.title:e.title.substr(0,20)+"..."+e.title.substr(-20),i.startedTabs.push(e))})}),startedTabIds=e)}n(),setInterval(n,1e3)}var o=0,s=0,a=!1,r=document.querySelector("#main-content"),h=document.querySelector("#pic-list");addWheelListener(r,function(e){"spread"!=this.viewModel&&this.config.pagination&&(a||(o+=e.deltaY,s+=e.deltaX,0==o&&setTimeout(function(){o=0},1e3),0==s&&setTimeout(function(){deltaX=0},1e3),o>=300&&r.scrollTop+r.offsetHeight>=h.offsetHeight&&(this.currentPage<Math.ceil(this.showImgList.length/this.pageSize)&&(this.currentPage++,r.scrollTop=0),o=0,a=!0,setTimeout(function(){a=!1},500)),o<=-300&&0==r.scrollTop&&(this.currentPage>1&&(this.currentPage--,r.scrollTop=h.offsetHeight-r.offsetHeight),o=0,a=!0,setTimeout(function(){a=!1},500)),s>=300&&r.scrollLeft+r.offsetWidth>=h.offsetWidth&&(this.currentPage<Math.ceil(this.showImgList.length/this.pageSize)&&(this.currentPage++,r.scrollLeft=0),s=0,a=!0,setTimeout(function(){a=!1},500)),s<=-300&&0==r.scrollLeft&&(this.currentPage>1&&(this.currentPage--,r.scrollLeft=h.offsetWidth-r.offsetWidth),s=0,a=!0,setTimeout(function(){a=!1},500))))}.bind(this))}i=this;if(setInterval(function(){newImgList.length>0&&(i.imgList=i.imgList.concat(newImgList),newImgList=[])},1e3),e.dragSelect){var g,u;document.body.addEventListener("dragstart",function(e){e.preventDefault()});var d,l,c,f;function p(){d=0,l=0,c=0,f=0,g=null,u=null,i.selectionBoxStyling={}}function m(e){Math.abs(e.pageX-g.x)<10&&Math.abs(e.pageY-g.y)<10||(u={x:e.pageX,y:e.pageY},d=Math.min(g.y,u.y),l=Math.min(g.x,u.x),c=Math.abs(u.x-g.x),f=Math.abs(u.y-g.y),i.selectionBoxStyling={top:d+"px",left:l+"px",width:c+"px",height:f+"px"})}function w(){!1,window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",w);var e=document.querySelector("#main-content");Math.abs(event.pageX-g.x)<10&&Math.abs(event.pageY-g.y)<10||(document.querySelectorAll(".img-item").forEach(function(t){if(utils.offset(t,"left")-e.scrollLeft+t.offsetWidth>l&&utils.offset(t,"top")-e.scrollTop+t.offsetHeight>d&&utils.offset(t,"left")-e.scrollLeft<l+c&&utils.offset(t,"top")-e.scrollTop<d+f){var n=_.find(i.showImgList,{id:t.id});n.selected=!n.selected}}),p())}p(),document.getElementById("main-content").addEventListener("mousedown",function(e){2!==e.button&&(!0,g={x:e.pageX,y:e.pageY},window.addEventListener("mousemove",m),window.addEventListener("mouseup",w))})}"jsds"==this.name&&(setInterval(()=>{this.stzsen=!this.stzsen},3e4),chrome.storage.local.get("stzsAdClicked",e=>{this.stzsAdClicked=!!e.stzsAdClicked}))},watch:{urlfilter:function(){this.currentPage=1},unique:function(){this.currentPage=1},saveTipsDoNotShowAgain:function(e){localStorage.saveTipsDoNotShowAgain=e},config:{handler:function(){appConfig.setConfig(this.config)},deep:!0}},methods:{addItem:function(e){("IMG"!=e.type||e.width&&e.height)&&(e.selected=!0,e.size=e.width*e.height,e.index=void 0!==e.index?e.index:this.imgList.length,e.status="added",e.w=e.width,e.h=e.height,e.src=e.bigUrl,e.id=e.tabIndex+"_"+e.frameId+"_"+e.index+e.src,newImgList.push(e),e.width>n.maxWidth&&(n.maxWidth=e.width,n.rememberFilter&&n.config.widthRange&&n.config.widthRange[1]?n.maxWidth>n.config.widthRange[1]&&(n.widthRange[1]=n.config.widthRange[1]):n.widthRange[1]=n.maxWidth),e.height>n.maxHeight&&(n.maxHeight=e.height,n.rememberFilter&&n.config.heightRange&&n.config.heightRange[1]?n.maxHeight>n.config.heightRange[1]&&(n.heightRange[1]=n.config.heightRange[1]):n.heightRange[1]=n.maxHeight),e.group&&-1==this.groups1.indexOf(e.group)&&(-1==e.groupIndex?this.groups1.push(e.group):this.groups1.splice(Math.min(e.groupIndex,this.groups1.length),0,e.group)),"drag"==outputType&&(document.title=e.docTitle))},checkSize:function(e){return"VIDEO"==e.type||(!this.widthRange||e.width>=this.widthRange[0]&&e.width<=this.widthRange[1])&&(!this.heightRange||e.height>=this.heightRange[0]&&e.height<=this.heightRange[1])},itemClick:function(e){var t=this.imgList.indexOf(e);e.selected=!e.selected,this.imgList.splice(t,1,e)},resetFilter:function(){this.config.widthRange=null,this.config.heightRange=null,appConfig.setConfig({widthRange:null,heightRange:null}),this.currentPage=1,this.widthRange=[0,this.maxWidth],this.heightRange=[0,this.maxHeight],this.urlfilter="",this.selectedTabs=""},resetWhRange:function(){this.config.widthRange=null,this.config.heightRange=null,appConfig.setConfig({widthRange:null,heightRange:null}),this.currentPage=1,this.widthRange=[0,this.maxWidth],this.heightRange=[0,this.maxHeight]},toggle:function(){this.showImgList.forEach(function(e){e.selected=!e.selected})},selectAll:function(){this.showImgList.forEach(function(e){e.selected=!0})},changeView:function(){this.viewModel="normal"==this.viewModel?"spread":"normal"},getDir:function(){return"FIXED"==e.dirType?e.fixedDir:tabTitle},realDowload:async function(){if(this.imgList.forEach(function(e,t){e.status="added"}),downloader.init(e,function(e,t){t.status=e,this.imgList.splice(this.imgList.indexOf(t),1,t),this.downloadedImgs.length+this.interruptedImgs.length==this.selectedImgs.length&&(downloader.status="complete")}.bind(this)),e.downloadZip){var t=null;this.config.recordPageInfo&&(t=this.getPageInfos()),this.downloading=!0;var i=this.$loading({text:this.getI18n("downloading"),background:"rgba(0, 0, 0, .4)"});await downloader.downloadZip(this.selectedImgs,t),t&&t.forEach(e=>{window.URL.revokeObjectURL(e.url)}),this.downloading=!1,i.close()}else downloader.download(this.selectedImgs),this.config.recordPageInfo&&"TITLE"==this.config.dirType&&this.recordPageInfo()},download:function(){this.saveTipsDoNotShowAgain?this.realDowload():this.showSaveTips=!0},getPageInfos:function(){var e=[],t=[];this.selectedImgs.forEach(function(t){e.find(e=>e.id==t.tabId)||e.push({id:t.tabId,docTitle:t.docTitle,url:t.ref})});var i={};for(var n in pageInfos.forEach(e=>{i[e.tabId]=i[e.tabId]||[],i[e.tabId].push(e.value)}),e.forEach(e=>{i[e.id]||(i[e.id]=[])}),i){let s=e.find(e=>e.id==n);var o=["Page Url:\r\n",s.url,"\r\n"].concat(i[n]).join("\r\n");t.push({text:o,filename:utils.getSafeDir(s.docTitle)+"/pageInfo.txt"})}return t},recordPageInfo:function(){for(var e=this.getPageInfos(),t=0;t<e.length;t++){var i=new Blob([e[t].text],{type:"text/plain"}),n=window.URL.createObjectURL(i);chrome.downloads.download({url:n,filename:e[t].filename,saveAs:!1,conflictAction:"uniquify"},(e=>()=>{window.URL.revokeObjectURL(e)})(e[t].url))}},viewBig:function(e,t){var i=document.querySelectorAll(".pswp")[0],n={index:(this.currentPage-1)*this.pageSize+e};new PhotoSwipe(i,PhotoSwipeUI_Default,t||this.showImgList,n).init()},openLink:function(e){chrome.tabs.create({url:e})},share:function(e){var t={url:e.bigUrl,title:"#Fatkun批量下载图片#",pic:e.bigUrl},i=[];for(var n in t)i.push(n+"="+encodeURIComponent(t[n]||""));window.open("http://service.weibo.com/share/share.php?"+i.join("&"),"_blank","width=615,height=405")},downloadSingle:function(t){downloader.init(e,function(e,t){t.status=e,this.imgList.splice(this.imgList.indexOf(t),1,t)}.bind(this)),downloader.downloadSingle(t)},pauseDownload:function(){"paused"==downloader.status?downloader.resume():downloader.pause()},saveToPin:function(){chrome.runtime.sendMessage("eehllckaggechnoimeokmdgmljlmhkma",{topic:"imgs_from_external",data:this.selectedImgs.map(e=>({url:e.bigUrl,picturewidth:e.w,pictureheight:e.h,source:e.ref}))},e=>{if(chrome.runtime.lastError){let e="https://chrome.google.com/webstore/detail/pinterest-save-pro/eehllckaggechnoimeokmdgmljlmhkma";this.$message({showClose:!0,dangerouslyUseHTMLString:!0,message:`You have not installed <a data-tj-btn="install-psp" target="_blank" href="${e}"><strong>pinterest save pro</strong></a>, <a data-tj-btn="install-psp" style="text-decoration: none;" target="_blank" href="${e}"><strong>Install Now</strong></a>`,type:"error"})}})},translateImage:async function(){let e=[];for(var t of this.selectedImgs.filter(e=>"VIDEO"!==e.type)){let i=await utils.toDataURL(t.bigUrl);e.push(i)}chrome.storage.local.set({translateImage:e},()=>{chrome.tabs.create({url:`${US_WEB_SERVER}${US_YT_PATH}`})})},cutoutImage:async function(){let e=[];for(var t of this.selectedImgs.filter(e=>"VIDEO"!==e.type)){let i=await utils.toDataURL(t.bigUrl);e.push(i)}chrome.storage.local.set({cutoutImage:e},()=>{chrome.tabs.create({url:`${US_WEB_SERVER}${US_KT_PATH}`})})},exportLinks:function(){this.showOutputTextPanel=!0},closeLinksPanel:function(){this.showOutputTextPanel=!1},openFolder:function(e){chrome.downloads.show(e)},resetOutputTextFormat:function(){this.outputTextFormat=appConfig.getDefaultConfig().outputTextFormat},changePage:function(e){this.currentPage=e},saveTipsClose:function(){this.showSaveTips=!1},saveTipsSave:function(){this.showSaveTips=!1,this.realDowload()},saveWidthRange:function(e){appConfig.setConfig({widthRange:[e[0],e[1]<n.maxWidth?e[1]:0]}),this.currentPage=1},saveHeightRange:function(e){appConfig.setConfig({heightRange:[e[0],e[1]<n.maxHeight?e[1]:0]}),this.currentPage=1},setMinWidth:function(e){this.widthRange=[e,this.widthRange[1]],appConfig.setConfig({widthRange:this.widthRange}),this.currentPage=1},setMaxWidth:function(e){this.widthRange=[this.widthRange[0],e],appConfig.setConfig({widthRange:this.widthRange}),this.currentPage=1},setMinHeight:function(e){this.heightRange=[e,this.heightRange[1]],appConfig.setConfig({heightRange:this.heightRange}),this.currentPage=1},setMaxHeight:function(e){this.heightRange=[this.heightRange[0],e],appConfig.setConfig({heightRange:this.heightRange}),this.currentPage=1},groupSelected:function(e,t){this.groupedImgs[e].imgs.forEach(function(e){e.selected=t})},downloadGroup:function(t){var i=this.groupedImgs[t].imgs;(i=_.filter(i,{selected:!0})).forEach(function(e,t){e.status="added"}),downloader.init(e,function(e,t){t.status=e,i.splice(i.indexOf(t),1,t),this.downloadedImgs.length+this.interruptedImgs.length==i.length&&(downloader.status="complete")}.bind(this)),downloader.download(i)},openSettingPage:function(){chrome.tabs.query({url:chrome.extension.getURL("settings/settings.htjl")},function(e){e.length>0?chrome.tabs.update(e[0].id,{active:!0}):chrome.tabs.create({url:chrome.extension.getURL("settings/settings.html")})})},stzsAdClick:function(){this.stzsAdClicked=!0,chrome.storage.local.set({stzsAdClicked:!0})},clickAdBtn:function(){setTimeout(function(){localStorage.outputAdBtnClicked=this.adBtnClicked=!0}.bind(this),1e3)},pauseCollect:function(){this.collectPaused=!this.collectPaused,chrome.tabs.sendMessage(tabId,{cmd:this.collectPaused?"PAUSE_COLLECT":"RESUME_COLLECT"})},getI18n:utils.getI18n,copyOutputText:function(){navigator.clipboard.writeText(this.outputText),this.$message({message:this.getI18n("outputTextCopyedTip"),type:"success"})}}})}function setCrossDomain(){function e(e){for(var t=0;t<e.responseHeaders.length&&"access-control-allow-origin"!=e.responseHeaders[t].name.toLowerCase();t++);return t<e.responseHeaders.length?e.responseHeaders[t].value:e.responseHeaders.push({name:"Access-Control-Allow-Origin",value:"*"}),{responseHeaders:e.responseHeaders}}try{chrome.webRequest.onHeadersReceived.addListener(e,{urls:["<all_urls>"]},["blocking","responseHeaders","extraHeaders"])}catch(t){chrome.webRequest.onHeadersReceived.addListener(e,{urls:["<all_urls>"]},["blocking","responseHeaders"])}}function setHeaders(e){var t=e.map(function(e){return e.name.toLowerCase()});function i(i){if(i.initiator&&i.initiator.indexOf(chrome.runtime.id)>0||gApp.imgList.map(e=>e.bigUrl).indexOf(i.url)>=0)return t.forEach(function(t,n){for(var o=0;o<i.requestHeaders.length;o++)i.requestHeaders[o].name.toLowerCase()==t&&(i.requestHeaders[o].value=e[n].value);o==i.requestHeaders.length&&i.requestHeaders.push(e[n])}),{requestHeaders:i.requestHeaders}}try{chrome.webRequest.onBeforeSendHeaders.addListener(i,{urls:["<all_urls>"]},["blocking","requestHeaders","extraHeaders"])}catch(e){chrome.webRequest.onBeforeSendHeaders.addListener(i,{urls:["<all_urls>"]},["blocking","requestHeaders"])}}outputType&&(outputType=outputType[1]),appConfig.init(function(e){_config=e,bigImgParser.init(function(){main(e)})}),document.body.addEventListener("click",function(e){var t=e.target.closest("[data-tj-btn]");t&&chrome.runtime.sendMessage({cmd:"GA",category:"btn-tj",action:t.dataset.tjBtn})},!0);